define(["require","exports","utils/browser-api","libs/aja/aja"],function(a,b,c,d){"use strict";var e=function(){function a(){}return a.getFbDtsg=function(a){var b=document.querySelector("input[name=fb_dtsg]"),c=b?b.value:"";if(c)return void a(c);for(var e,f,g=document.getElementsByTagName("script"),h=0,i=g.length;i>h;h++)if(f=g[h].innerText,e=f.match(/\{"token"\:"([^"]+)"\}/))return void a(e[1]);d().url("https://m.facebook.com/me?v=info&refid=17&__m_async_page__=&__ajax__=").method("get").type("html").on("success",function(b){for(var c,d=[/name=\\"fb_dtsg\\" value=\\"([^"]+)\\"/,/\\"dtsg\\":\\"([^"]+)\\"/],e=0;e<d.length&&(c=b.match(d[e]),!c||!c[1]);e++);a(c&&c[1]?c[1]:"")}).on("error",function(){a()}).go()},a.getUserIdFromCookie=function(a){c.Cookies.get({url:"https://www.messenger.com",name:"c_user"},function(b){var c="";b&&b.value&&(c=b.value),a(c)})},a.changeThreadColor=function(a,b,c){var e={color_choice:a,thread_or_other_fbid:c.id,__user:b.id,fb_dtsg:b.fbDtsg,__a:1,__req:"f",__be:0,__pc:"EXP1:messengerdotcom_pkg"};d().url("https://www.messenger.com/messaging/save_thread_color/").queryString({dpr:"1",source:"thread_settings"}).type("html").method("post").header("Content-Type","application/x-www-form-urlencoded").data(e).on("success",function(a){}).go()},a}();return e});